–õ–µ–Ω–∞, –¥–∞ üòä –ù–∏–∂–µ —è **—Ä–∞—Å–ø–∏—Å–∞–ª–∞ –∫–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã —Ç–≤–æ–µ–≥–æ –∫–æ–¥–∞ ‚Äú–∫–∞–∫ –æ—Ç—á—ë—Ç‚Äù**: —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–∞–∂–¥—ã–π –±–ª–æ–∫, –∑–∞—á–µ–º –æ–Ω –Ω—É–∂–µ–Ω, –∫–∞–∫–∏–µ –≤—Ö–æ–¥—ã/–≤—ã—Ö–æ–¥—ã, –∏ –∫–∞–∫–∏–µ –≤–∞–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –∑–∞–ª–æ–∂–µ–Ω—ã. –≠—Ç–æ –º–æ–∂–Ω–æ –ø—Ä—è–º–æ –≤—Å—Ç–∞–≤–ª—è—Ç—å –≤ –ø–æ—è—Å–Ω–∏—Ç–µ–ª—å–Ω—É—é –∑–∞–ø–∏—Å–∫—É (—Ä–∞–∑–¥–µ–ª ‚Äú–†–µ–∞–ª–∏–∑–∞—Ü–∏—è‚Äù / ‚Äú–û–ø–∏—Å–∞–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞‚Äù).

---

## 1) –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã

**–¶–µ–ª—å:** —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Ç–æ—Ç–∏–ø –Ω–µ–π—Ä–æ—Å–µ—Ç–∏, –∫–æ—Ç–æ—Ä–∞—è —Ä–µ—à–∞–µ—Ç –∑–∞–¥–∞—á—É **–±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**:

* –∫–ª–∞—Å—Å **1** ‚Äî ¬´–ª–∏—Ü–æ¬ª
* –∫–ª–∞—Å—Å **0** ‚Äî ¬´–Ω–µ –ª–∏—Ü–æ¬ª

**–í—Ö–æ–¥:** –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ –ø–∞–ø–æ–∫ `data/faces` –∏ `data/non_faces`
**–í—ã—Ö–æ–¥:**

* –æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å (`.keras`) –≤ –ø–∞–ø–∫–µ `models/`
* –≥—Ä–∞—Ñ–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è (accuracy/loss) –≤ –ø–∞–ø–∫–µ `results/`
* –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª—é–±–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –º–µ–Ω—é

---

## 2) –ò–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫ –∏ –∏—Ö —Ä–æ–ª—å

```python
import cv2, numpy as np, matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
import tensorflow as tf
from tensorflow.keras import layers
```

* **OpenCV (cv2)** ‚Äî —á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, resize, —Ü–≤–µ—Ç–æ–≤—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è.
* **NumPy** ‚Äî —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –º–∞—Å—Å–∏–≤–µ, –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è, —Å–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä.
* **Matplotlib** ‚Äî –≥—Ä–∞—Ñ–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è (—Ç–æ—á–Ω–æ—Å—Ç—å/–ø–æ—Ç–µ—Ä–∏).
* **train_test_split** ‚Äî –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∫–∏ –Ω–∞ –æ–±—É—á–∞—é—â—É—é –∏ —Ç–µ—Å—Ç–æ–≤—É—é.
* **TensorFlow/Keras** ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –æ–±—É—á–µ–Ω–∏–µ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ (CNN).

---

## 3) –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞

```python
DATA_PATH = "data"
IMG_SIZE = (64, 64)
BATCH_SIZE = 32
EPOCHS = 20
MODELS_DIR = "models"
RESULTS_DIR = "results"
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ:**

* `IMG_SIZE = (64,64)` ‚Äî —É—Å–∫–æ—Ä—è–µ—Ç –æ–±—É—á–µ–Ω–∏–µ, —É–º–µ–Ω—å—à–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –ü–ö.
* `BATCH_SIZE = 32` ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –±–∞–ª–∞–Ω—Å —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –æ–±—É—á–µ–Ω–∏—è.
* `EPOCHS = 20` ‚Äî –≤–µ—Ä—Ö–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞; —Ä–µ–∞–ª—å–Ω–æ –æ–±—É—á–µ–Ω–∏–µ –º–æ–∂–µ—Ç –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è —Ä–∞–Ω—å—à–µ (EarlyStopping).
* –ü–∞–ø–∫–∏ `models/` –∏ `results/` ‚Äî —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ (–º–æ–¥–µ–ª—å/–≥—Ä–∞—Ñ–∏–∫–∏).

---

## 4) –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞ (create_test_data)

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è

–ï—Å–ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è **–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö**, –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Å–æ–∑–¥–∞—ë—Ç ‚Äú—Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π –¥–∞—Ç–∞—Å–µ—Ç‚Äù:

* 100 ‚Äú–ª–∏—Ü‚Äù ‚Äî –ø—Ä–æ—Å—Ç—ã–µ —Ä–∏—Å—É–Ω–∫–∏ (–æ–≤–∞–ª + –≥–ª–∞–∑–∞ + —Ä–æ—Ç)
* 100 ‚Äú–Ω–µ-–ª–∏—Ü‚Äù ‚Äî —Ñ–∏–≥—É—Ä—ã (–∫–≤–∞–¥—Ä–∞—Ç/—Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫/–∫—Ä—É–≥)

### –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ

–ß—Ç–æ–±—ã –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–ø—É—Å–∫–∞–ª–∞—Å—å **–¥–∞–∂–µ –±–µ–∑ –Ω–∞—Å—Ç–æ—è—â–∏—Ö —Ñ–æ—Ç–æ**, –∏ –º–æ–∂–Ω–æ –±—ã–ª–æ:

* –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø–∞–π–ø–ª–∞–π–Ω–∞ (–∑–∞–≥—Ä—É–∑–∫–∞ ‚Üí –æ–±—É—á–µ–Ω–∏–µ ‚Üí —Ç–µ—Å—Ç ‚Üí –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ)
* –ø–æ–ª—É—á–∏—Ç—å —Ä–∞–±–æ—á–∏–π –ø—Ä–æ—Ç–æ—Ç–∏–ø

### –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

* `np.zeros(...)` ‚Äî —Å–æ–∑–¥–∞—ë—Ç—Å—è –ø—É—Å—Ç–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞
* `cv2.ellipse / cv2.circle / cv2.rectangle` ‚Äî —Ä–∏—Å—É—é—Ç—Å—è —ç–ª–µ–º–µ–Ω—Ç—ã
* `cv2.cvtColor(img, cv2.COLOR_RGB2BGR)` ‚Äî **–≤–∞–∂–Ω–æ**, –ø–æ—Ç–æ–º—É —á—Ç–æ OpenCV —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ **BGR**

---

## 5) –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö (load_and_prepare_data)

### –õ–æ–≥–∏–∫–∞ —Ñ—É–Ω–∫—Ü–∏–∏

1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –ø–∞–ø–æ–∫ `data/faces` –∏ `data/non_faces`.
2. –ï—Å–ª–∏ –ø–∞–ø–æ–∫ –Ω–µ—Ç ‚Äî –≤—ã–∑—ã–≤–∞–µ—Ç `create_test_data()`.
3. –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∫–∞—Ä—Ç–∏–Ω–∫–∏, –ø—Ä–∏–≤–æ–¥–∏—Ç –∏—Ö –∫ –æ–¥–Ω–æ–º—É —Ä–∞–∑–º–µ—Ä—É –∏ —Ñ–æ—Ä–º–∞—Ç—É.
4. –°–æ–∑–¥–∞—ë—Ç –º–∞—Å—Å–∏–≤—ã:

* `X` ‚Äî –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
* `y` ‚Äî –º–µ—Ç–∫–∏ –∫–ª–∞—Å—Å–æ–≤ (1/0)

5. –î–µ–ª–∏—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ –æ–±—É—á–∞—é—â—É—é –∏ —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫—É.

### –ö–ª—é—á–µ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è

**1) Resize**

```python
img = cv2.resize(img, IMG_SIZE)
```

–ù–µ–π—Ä–æ—Å–µ—Ç—å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—Ö–æ–¥ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞. –≠—Ç–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —à–∞–≥.

**2) –ü—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –∫ RGB**

```python
img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)
```

OpenCV —á–∏—Ç–∞–µ—Ç –∫–∞–∫ **BGR**, –∞ –¥–ª—è –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏—è –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø–µ—Ä–µ–≤–æ–¥–∏–º –≤ **RGB**.

**3) –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è**

```python
X = np.array(images, dtype="float32") / 255.0
```

–ü–∏–∫—Å–µ–ª–∏ –ø–µ—Ä–µ–≤–æ–¥—è—Ç—Å—è –∏–∑ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ **0..255** –≤ **0..1** ‚Äî —Ç–∞–∫ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ –æ–±—É—á–∞—é—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ.

**4) –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–≤—É—Ö –∫–ª–∞—Å—Å–æ–≤**

```python
if len(np.unique(y)) < 2:
```

–ï—Å–ª–∏ –≤–¥—Ä—É–≥ –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∫–ª–∞—Å—Å ‚Äî –æ–±—É—á–µ–Ω–∏–µ –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω–æ, –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è.

**5) –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –¥–µ–ª–µ–Ω–∏–µ train/test**

```python
train_test_split(..., stratify=y)
```

`stratify=y` —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ –∫–ª–∞—Å—Å–æ–≤ –≤ train –∏ test (—á—Ç–æ–±—ã —Ç–µ—Å—Ç –±—ã–ª —á–µ—Å—Ç–Ω—ã–º).

---

## 6) –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ CNN (create_model)

### –ü–æ—á–µ–º—É CNN?

–°–≤—ë—Ä—Ç–æ—á–Ω—ã–µ —Å–µ—Ç–∏ –ª—É—á—à–µ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: –æ–Ω–∏ ‚Äú–≤–∏–¥—è—Ç‚Äù –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–æ—Ä–º—ã (–∫–æ–Ω—Ç—É—Ä—ã, –ø—è—Ç–Ω–∞, —ç–ª–µ–º–µ–Ω—Ç—ã).

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```python
Conv2D(32) -> MaxPool
Conv2D(64) -> MaxPool
Flatten -> Dense(128) -> Dropout(0.5) -> Dense(64) -> Dense(1,sigmoid)
```

**–ü–æ—è—Å–Ω–µ–Ω–∏–µ –±–ª–æ–∫–æ–≤:**

* `Conv2D` ‚Äî –∏–∑–≤–ª–µ–∫–∞–µ—Ç –ø—Ä–∏–∑–Ω–∞–∫–∏ (–ø—Ä–æ—Å—Ç—ã–µ ‚Üí —Å–ª–æ–∂–Ω—ã–µ).
* `MaxPooling2D` ‚Äî —É–º–µ–Ω—å—à–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –∫–∞—Ä—Ç—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è.
* `Flatten` ‚Äî –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç ‚Äú–∫–∞—Ä—Ç—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤‚Äù –≤ –≤–µ–∫—Ç–æ—Ä.
* `Dense` ‚Äî –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –ø—Ä–∏–∑–Ω–∞–∫–∞–º.
* `Dropout(0.5)` ‚Äî —Å–Ω–∏–∂–∞–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (—Å–ª—É—á–∞–π–Ω–æ –æ—Ç–∫–ª—é—á–∞–µ—Ç —á–∞—Å—Ç—å –Ω–µ–π—Ä–æ–Ω–æ–≤).
* `Dense(1, sigmoid)` ‚Äî –≤—ã–¥–∞—ë—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å ‚Äú—ç—Ç–æ –ª–∏—Ü–æ‚Äù.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—É—á–µ–Ω–∏—è

```python
model.compile(optimizer="adam",
              loss="binary_crossentropy",
              metrics=["accuracy"])
```

* `binary_crossentropy` ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏.
* `accuracy` ‚Äî –ø–æ–Ω—è—Ç–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞ –¥–ª—è –æ—Ç—á—ë—Ç–∞.

---

## 7) –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ (train_model)

### –ü–æ—á–µ–º—É –¥–æ–±–∞–≤–ª–µ–Ω—ã callbacks

**1) ModelCheckpoint**
–°–æ—Ö—Ä–∞–Ω—è–µ—Ç **–ª—É—á—à—É—é –º–æ–¥–µ–ª—å** –ø–æ `val_accuracy`, –ø–æ—Ç–æ–º—É —á—Ç–æ –ª—É—á—à–∞—è —ç–ø–æ—Ö–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π.

**2) EarlyStopping**
–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –æ–±—É—á–µ–Ω–∏–µ, –µ—Å–ª–∏ `val_loss` –Ω–µ —É–ª—É—á—à–∞–µ—Ç—Å—è `patience=5` —ç–ø–æ—Ö.
–≠—Ç–æ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è –∏ —ç–∫–æ–Ω–æ–º–∏—Ç –≤—Ä–µ–º—è.

### –í–∞–∂–Ω–æ

–í–∞–ª–∏–¥–∞—Ü–∏—è –∏–¥—ë—Ç –Ω–∞ `X_test, y_test`:

```python
validation_data=(X_test, y_test)
```

---

## 8) –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ (evaluate_model)

```python
test_loss, test_acc = model.evaluate(X_test, y_test)
```

–ù–∞ —Ç–µ—Å—Ç–µ –≤—ã–≤–æ–¥–∏—Ç—Å—è:

* **—Ç–æ—á–Ω–æ—Å—Ç—å** (%)
* **–æ—à–∏–±–∫–∞** (loss)

–≠—Ç–æ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ –∏—Ç–æ–≥ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞.

---

## 9) –ì—Ä–∞—Ñ–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è (plot_training_history)

–°—Ç—Ä–æ—è—Ç—Å—è –¥–≤–µ –¥–∏–∞–≥—Ä–∞–º–º—ã:

* `accuracy` –∏ `val_accuracy`
* `loss` –∏ `val_loss`

**–ó–∞—á–µ–º –≤ –æ—Ç—á—ë—Ç–µ:**

* –µ—Å–ª–∏ train —Ä–∞—Å—Ç—ë—Ç, –∞ val –ø–∞–¥–∞–µ—Ç ‚Üí –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ
* –µ—Å–ª–∏ –æ–±–µ —Ä–∞—Å—Ç—É—Ç ‚Üí –æ–±—É—á–µ–Ω–∏–µ –∞–¥–µ–∫–≤–∞—Ç–Ω–æ–µ
* –ø–æ loss –≤–∏–¥–Ω–æ –∫–∞—á–µ—Å—Ç–≤–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

–ì—Ä–∞—Ñ–∏–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `results/accuracy.png` –∏ `results/loss.png`.

---

## 10) –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ–¥–Ω–æ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ (test_on_single_image)

### –ü–æ—á–µ–º—É –≤–∞–∂–Ω–∞ –æ–¥–∏–Ω–∞–∫–æ–≤–∞—è –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞

–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ –ø–æ–¥–∞—á–µ–π –≤ –º–æ–¥–µ–ª—å –ø—Ä–æ—Ö–æ–¥–∏—Ç **—Ç–æ—Ç –∂–µ –ø—É—Ç—å**, —á—Ç–æ –∏ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏:

* resize ‚Üí RGB ‚Üí float32 ‚Üí /255 ‚Üí expand_dims

```python
x = np.expand_dims(img_norm, axis=0)
```

`expand_dims` –¥–æ–±–∞–≤–ª—è–µ—Ç —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å ‚Äú–±–∞—Ç—á–∞‚Äù, –ø–æ—Ç–æ–º—É —á—Ç–æ –º–æ–¥–µ–ª—å –∂–¥—ë—Ç —Ñ–æ—Ä–º—É:
`(batch, height, width, channels)`.

### –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

`pred` ‚Äî –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å ‚Äú–ª–∏—Ü–æ‚Äù:

* –µ—Å–ª–∏ `pred > 0.5` ‚Üí –ª–∏—Ü–æ
* –∏–Ω–∞—á–µ ‚Üí –Ω–µ –ª–∏—Ü–æ

–¢–µ–∫—Å—Ç —Ä–∏—Å—É–µ—Ç—Å—è –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ —á–µ—Ä–µ–∑ `cv2.putText`, –∏ –∫–∞—Ä—Ç–∏–Ω–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ –æ–∫–Ω–µ.

---

## 11) –ì–ª–∞–≤–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π —Ä–∞–±–æ—Ç—ã (main)

–ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:

1. –∑–∞–≥—Ä—É–∑–∫–∞/—Å–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
2. —Å–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏
3. –æ–±—É—á–µ–Ω–∏–µ
4. –æ—Ü–µ–Ω–∫–∞
5. —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Ç–æ–≥–æ–≤–æ–π –º–æ–¥–µ–ª–∏
6. –º–µ–Ω—é –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç —Ä–µ–∂–∏–º)

---

## 12) –ß—Ç–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å, —á—Ç–æ–±—ã –æ—Ç—á—ë—Ç –±—ã–ª –µ—â—ë —Å–∏–ª—å–Ω–µ–µ (–ø–æ –∂–µ–ª–∞–Ω–∏—é)

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å –ø—Ä—è–º ‚Äú–∫–∞–∫ —É –≤–∑—Ä–æ—Å–ª—ã—Ö‚Äù üòÑ, –¥–æ–±–∞–≤—å:

1. **confusion matrix (–º–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫)**
2. **precision/recall/F1**
3. —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ **–ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏** –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –µ—ë –ø–µ—Ä–µ–¥ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
4. —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã–π –ª–æ–≥ `results/report.txt`

---

–ï—Å–ª–∏ —Å–∫–∞–∂–µ—à—å ‚Äú–¥–∞‚Äù, —è —Ç–µ–±–µ —Å—Ä–∞–∑—É –¥–æ–ø–∏—à—É –∫ –∫–æ–¥—É 10‚Äì15 —Å—Ç—Ä–æ–∫, –∫–æ—Ç–æ—Ä—ã–µ:

* —Å—Ç—Ä–æ—è—Ç confusion matrix
* –ø–µ—á–∞—Ç–∞—é—Ç classification report
* —Å–æ—Ö—Ä–∞–Ω—è—é—Ç –≤—Å—ë –≤ —Ñ–∞–π–ª –æ—Ç—á—ë—Ç–∞ (–æ—á–µ–Ω—å –∫—Ä–∞—Å–∏–≤–æ –¥–ª—è –í–ö–†) ‚úÖ
* –û—Ç–ª–∏—á–Ω—ã–π –∫–æ–¥! –≠—Ç–æ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ –¥–ª—è –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–ª–∏—Ü–æ/–Ω–µ –ª–∏—Ü–æ). –î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º –µ–≥–æ –ø–æ —á–∞—Å—Ç—è–º:

–ì–õ–û–ë–ê–õ–¨–ù–ê–Ø –°–¢–†–£–ö–¢–£–†–ê

```
1. –ò–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫
2. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç
3. –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
4. –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è main()
```

–í–ê–ñ–ù–ï–ô–®–ò–ï –ú–û–ú–ï–ù–¢–´ –ö–û–î–ê

1. –ö–û–ù–°–¢–ê–ù–¢–´ –ò –ù–ê–°–¢–†–û–ô–ö–ò

```python
IMG_SIZE = (64, 64)          # –í—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É—é—Ç—Å—è –¥–æ 64x64 –ø–∏–∫—Å–µ–ª–µ–π
BATCH_SIZE = 32             # –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
EPOCHS = 20                 # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö
```

¬∑ IMG_SIZE - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ! –ù–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å —Ç—Ä–µ–±—É–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
¬∑ –ú–∞–ª–µ–Ω—å–∫–∏–π —Ä–∞–∑–º–µ—Ä (64x64) —É—Å–∫–æ—Ä—è–µ—Ç –æ–±—É—á–µ–Ω–∏–µ, –Ω–æ –º–æ–∂–µ—Ç —Å–Ω–∏–∑–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ

2. –°–û–ó–î–ê–ù–ò–ï –¢–ï–°–¢–û–í–´–• –î–ê–ù–ù–´–•

```python
def create_test_data():
```

¬∑ –°–æ–∑–¥–∞–µ—Ç –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –µ—Å–ª–∏ —Ä–µ–∞–ª—å–Ω—ã—Ö –Ω–µ—Ç
¬∑ –õ–∏—Ü–∞: –æ–≤–∞–ª —Å –≥–ª–∞–∑–∞–º–∏ –∏ —Ä—Ç–æ–º (–≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–∏—Ç–∏–≤—ã)
¬∑ –ù–µ-–ª–∏—Ü–∞: —Å–ª—É—á–∞–π–Ω—ã–µ –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ —Ñ–∏–≥—É—Ä—ã
¬∑ –í–∞–∂–Ω–æ: —ç—Ç–æ –¢–û–õ–¨–ö–û –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏! –†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –ø–∞–ø–∫–∞—Ö:
  ¬∑ data/faces/ - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ª–∏—Ü
  ¬∑ data/non_faces/ - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—Å–µ–≥–æ –æ—Å—Ç–∞–ª—å–Ω–æ–≥–æ

3. –ó–ê–ì–†–£–ó–ö–ê –ò –ü–û–î–ì–û–¢–û–í–ö–ê –î–ê–ù–ù–´–•

```python
# –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è:
X = np.array(images, dtype="float32") / 255.0
```

¬∑ –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è (–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ 255) - –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –∑–Ω–∞—á–µ–Ω–∏—è –ø–∏–∫—Å–µ–ª–µ–π –∏–∑ [0, 255] –≤ [0, 1]
¬∑ –£–ª—É—á—à–∞–µ—Ç —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏
¬∑ –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —ç—Ç–∞–ø –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏

```python
# –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42, stratify=y
)
```

¬∑ stratify=y - —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ –∫–ª–∞—Å—Å–æ–≤ (50% –ª–∏—Ü, 50% –Ω–µ-–ª–∏—Ü)
¬∑ random_state=42 - –¥–µ–ª–∞–µ—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã–º

4. –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –ù–ï–ô–†–û–ù–ù–û–ô –°–ï–¢–ò

```python
model = tf.keras.Sequential([
    layers.Input(shape=input_shape),
    
    # –°–≤–µ—Ä—Ç–æ—á–Ω—ã–µ —Å–ª–æ–∏ –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
    layers.Conv2D(32, (3, 3), activation="relu", padding="same"),
    layers.MaxPooling2D((2, 2)),  # –£–º–µ–Ω—å—à–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –≤ 2 —Ä–∞–∑–∞
    
    layers.Conv2D(64, (3, 3), activation="relu", padding="same"),
    layers.MaxPooling2D((2, 2)),
    
    # –ü–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–µ —Å–ª–æ–∏ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
    layers.Flatten(),  # –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ 2D –≤ 1D
    layers.Dense(128, activation="relu"),
    layers.Dropout(0.5),  # –†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è –¥–ª—è –±–æ—Ä—å–±—ã —Å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ–º
    layers.Dense(64, activation="relu"),
    layers.Dense(1, activation="sigmoid")  # –ë–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è
])
```

–ö–ª—é—á–µ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã:

¬∑ Conv2D - —Å–≤–µ—Ä—Ç–æ—á–Ω—ã–µ —Å–ª–æ–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—é—Ç –ø–∞—Ç—Ç–µ—Ä–Ω—ã (–∫—Ä–∞—è, —Ç–µ–∫—Å—Ç—É—Ä—ã, –≥–ª–∞–∑–∞ –∏ —Ç.–¥.)
¬∑ MaxPooling2D - —É–º–µ–Ω—å—à–∞–µ—Ç —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å, –æ—Å—Ç–∞–≤–ª—è—è –Ω–∞–∏–±–æ–ª–µ–µ –≤–∞–∂–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
¬∑ Dropout(0.5) - —Å–ª—É—á–∞–π–Ω–æ "–æ—Ç–∫–ª—é—á–∞–µ—Ç" 50% –Ω–µ–π—Ä–æ–Ω–æ–≤ –≤–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
¬∑ Sigmoid - —Ñ—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –¥–ª—è –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–≤—ã–¥–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ç 0 –¥–æ 1)

5. CALLBACKS –î–õ–Ø –û–ë–£–ß–ï–ù–ò–Ø

```python
checkpoint = tf.keras.callbacks.ModelCheckpoint(
    filepath=os.path.join(MODELS_DIR, "best_face_model.keras"),
    monitor="val_accuracy",
    save_best_only=True,
    mode="max"
)

early_stop = tf.keras.callbacks.EarlyStopping(
    monitor="val_loss",
    patience=5,
    restore_best_weights=True
)
```

¬∑ ModelCheckpoint - —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –º–æ–¥–µ–ª—å —Å –Ω–∞–∏–ª—É—á—à–µ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
¬∑ EarlyStopping - –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –æ–±—É—á–µ–Ω–∏–µ, –µ—Å–ª–∏ –∫–∞—á–µ—Å—Ç–≤–æ –Ω–µ —É–ª—É—á—à–∞–µ—Ç—Å—è 5 —ç–ø–æ—Ö
¬∑ –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –∏ —ç–∫–æ–Ω–æ–º–∏—Ç –≤—Ä–µ–º—è

6. –§–£–ù–ö–¶–ò–Ø –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø

```python
def test_on_single_image(model, image_path):
```

¬∑ –í–∞–∂–Ω–æ: –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç —Ç—É –∂–µ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫—É, —á—Ç–æ –∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
  1. –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –¥–æ 64x64
  2. –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ RGB
  3. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è (–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ 255)
¬∑ np.expand_dims(img_norm, axis=0) - –¥–æ–±–∞–≤–ª—è–µ—Ç batch dimension (–∏–∑ (64,64,3) –≤ (1,64,64,3))

7. –û–°–ù–û–í–ù–û–ô –¶–ò–ö–õ –ü–†–û–ì–†–ê–ú–ú–´

```python
def main():
    # 1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    # 2. –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏
    # 3. –û–±—É—á–µ–Ω–∏–µ
    # 4. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
    # 5. –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```

¬∑ –ü—Ä–æ–≥—Ä–∞–º–º–∞ –æ–±—É—á–∞–µ—Ç –º–æ–¥–µ–ª—å –æ–¥–∏–Ω —Ä–∞–∑, –∑–∞—Ç–µ–º –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
¬∑ –î–≤–∞ —Ä–µ–∂–∏–º–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: –Ω–∞ —Å–≤–æ–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –∏–ª–∏ —Å–ª—É—á–∞–π–Ω–æ–º –∏–∑ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏

–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–´–ï –î–ï–¢–ê–õ–ò

1. –ü–†–ï–î–û–ë–†–ê–ë–û–¢–ö–ê –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ô

```python
img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)  # OpenCV —á–∏—Ç–∞–µ—Ç –∫–∞–∫ BGR, –∞ –Ω–µ RGB!
```

¬∑ OpenCV –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ—Ä—è–¥–æ–∫ BGR, –∞ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏ –æ–±—ã—á–Ω–æ –æ–±—É—á–∞—é—Ç—Å—è –Ω–∞ RGB
¬∑ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å!

2. –ë–ê–õ–ê–ù–° –ö–õ–ê–°–°–û–í

¬∑ –ö–æ–¥ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç —Ä–∞–≤–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ª–∏—Ü –∏ –Ω–µ-–ª–∏—Ü
¬∑ –ï—Å–ª–∏ –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–∏—Å–±–∞–ª–∞–Ω—Å, –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–µ—Å–∞ –∫–ª–∞—Å—Å–æ–≤ –∏–ª–∏ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—é

3. –û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø

¬∑ –ú–æ–¥–µ–ª—å –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–∞—è, –º–æ–∂–µ—Ç –ø–ª–æ—Ö–æ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
¬∑ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–ª–∏—à–∫–æ–º –∏–¥–µ–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
¬∑ –î–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω—É–∂–Ω—ã:
  ¬∑ –†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (—Ç—ã—Å—è—á–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
  ¬∑ –ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (–ø–æ–≤–æ—Ä–æ—Ç—ã, —Å–¥–≤–∏–≥–∏, –∏–∑–º–µ–Ω–µ–Ω–∏–µ —è—Ä–∫–æ—Å—Ç–∏)
  ¬∑ –ë–æ–ª–µ–µ –≥–ª—É–±–æ–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–µ—Ç–∏

–ß–¢–û –ú–û–ñ–ù–û –£–õ–£–ß–®–ò–¢–¨

1. –ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:

```python
from tensorflow.keras.preprocessing.image import ImageDataGenerator
datagen = ImageDataGenerator(rotation_range=20, width_shift_range=0.2, ...)
```

1. –ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:

¬∑ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ (VGG16, ResNet, MobileNet)
¬∑ –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö —Å–ª–æ–µ–≤

1. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π:

¬∑ –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å heatmap (–∫–∞–∫–∏–µ –æ–±–ª–∞—Å—Ç–∏ –≤–ª–∏—è—é—Ç –Ω–∞ —Ä–µ—à–µ–Ω–∏–µ)

–≠—Ç–æ –æ—Ç–ª–∏—á–Ω—ã–π –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Å–æ–∑–¥–∞–Ω–∏—è CNN –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π!
–û—Ç–ª–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å! –î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º –≥–ª—É–±–æ–∫–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏ –∫–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥–ª–∏ –±—ã—Ç—å –Ω–µ–æ—á–µ–≤–∏–¥–Ω—ã:

1. np.expand_dims() - –ú–ê–ì–ò–Ø –ò–ó–ú–ï–†–ï–ù–ò–ô

```python
x = np.expand_dims(img_norm, axis=0)
```

–ß—Ç–æ –¥–µ–ª–∞–µ—Ç: –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –º–∞—Å—Å–∏–≤ —Ñ–æ—Ä–º—ã (64, 64, 3) –≤ (1, 64, 64, 3)

–ü–æ—á–µ–º—É —ç—Ç–æ –ö–†–ò–¢–ò–ß–ï–°–ö–ò –≤–∞–∂–Ω–æ:

¬∑ –ù–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å –æ–∂–∏–¥–∞–µ—Ç –±–∞—Ç—á –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –∞ –Ω–µ –æ–¥–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
¬∑ axis=0 –¥–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤—É—é –æ—Å—å –≤ –Ω–∞—á–∞–ª–æ (–æ—Å—å –±–∞—Ç—á–∞)
¬∑ –ë–µ–∑ —ç—Ç–æ–≥–æ –º–æ–¥–µ–ª—å –≤—ã–¥–∞—Å—Ç –æ—à–∏–±–∫—É: –æ–∂–∏–¥–∞–ª–∞ 4D —Ç–µ–Ω–∑–æ—Ä, –ø–æ–ª—É—á–∏–ª–∞ 3D

–ê–Ω–∞–ª–æ–≥–∏—è: –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã –¥–∞–µ—Ç–µ –∫–æ—Ä–æ–±–∫—É –∫–æ–Ω—Ñ–µ—Ç (–±–∞—Ç—á) vs –æ–¥–Ω—É –∫–æ–Ω—Ñ–µ—Ç—É

2. stride –∏ padding –≤ —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö —Å–ª–æ—è—Ö

```python
layers.Conv2D(32, (3, 3), activation="relu", padding="same")
```

–ß—Ç–æ —Ç–∞–∫–æ–µ padding="same":

```python
# –ë–µ–∑ padding:
–≤—Ö–æ–¥: 64x64 ‚Üí —Å–≤–µ—Ä—Ç–∫–∞ 3x3 ‚Üí –≤—ã—Ö–æ–¥: 62x62 (–∫—Ä–∞—è "—Å—ä–µ–¥–∞—é—Ç—Å—è")

# –° padding="same":
–≤—Ö–æ–¥: 64x64 ‚Üí –¥–æ–±–∞–≤–ª—è–µ–º –Ω—É–ª–∏ –ø–æ –∫—Ä–∞—è–º ‚Üí —Å–≤–µ—Ä—Ç–∫–∞ ‚Üí –≤—ã—Ö–æ–¥: 64x64
```

–ó–∞—á–µ–º: –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å! –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ Conv2D —Ä–∞–∑–º–µ—Ä –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è, –º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ MaxPooling2D.

–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–≤–µ—Ä—Ç–∫–∞:

```
–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:           –Ø–¥—Ä–æ 3x3:
[[1, 0, 1],            [[1, 0, -1],
 [0, 1, 0],     *       [1, 0, -1],
 [1, 0, 1]]             [1, 0, -1]]

–û–ø–µ—Ä–∞—Ü–∏—è: —É–º–Ω–æ–∂–∞–µ–º –∏ —Å—É–º–º–∏—Ä—É–µ–º
1*1 + 0*0 + 1*(-1) + 
0*1 + 1*0 + 0*(-1) + 
1*1 + 0*0 + 1*(-1) = 0
```

–†–µ–∑—É–ª—å—Ç–∞—Ç: –Ø–¥—Ä–æ —É—á–∏—Ç—Å—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã (–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏, —É–≥–ª—ã –∏ —Ç.–¥.)

3. –§—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ sigmoid vs softmax

```python
layers.Dense(1, activation="sigmoid")
```

–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ sigmoid:

¬∑ –§–æ—Ä–º—É–ª–∞: œÉ(x) = 1 / (1 + e^(-x))
¬∑ –í—ã–¥–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç 0 –¥–æ 1 (–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å)

–†–∞–∑–Ω–∏—Ü–∞:

```python
# –ë–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è (2 –∫–ª–∞—Å—Å–∞):
output = Dense(1, activation="sigmoid")
# –í—ã–≤–æ–¥: [0.7] - 70% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å–∞ 1

# –ú–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è (>2 –∫–ª–∞—Å—Å–æ–≤):
output = Dense(10, activation="softmax")
# –í—ã–≤–æ–¥: [0.1, 0.8, 0.05, ...] - —Å—É–º–º–∞ = 1
```

–ü–æ—Ä–æ–≥ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏—è:

```python
if pred > 0.5:  # –ü–æ—Ä–æ–≥ –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å!
    return "–õ–ò–¶–û"
else:
    return "–ù–ï –õ–ò–¶–û"
```

4. Loss —Ñ—É–Ω–∫—Ü–∏—è binary_crossentropy - –ú–ê–¢–ï–ú–ê–¢–ò–ö–ê –û–®–ò–ë–û–ö

```python
model.compile(loss="binary_crossentropy", ...)
```

–§–æ—Ä–º—É–ª–∞ –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞:

```
L(y, ≈∑) = -[y * log(≈∑) + (1 - y) * log(1 - ≈∑)]
```

–≥–¥–µ:

¬∑ y - –∏—Å—Ç–∏–Ω–Ω–∞—è –º–µ—Ç–∫–∞ (0 –∏–ª–∏ 1)
¬∑ ≈∑ - –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ (0-1)

–ü—Ä–∏–º–µ—Ä—ã:

```
–ï—Å–ª–∏ y=1 (—ç—Ç–æ –ª–∏—Ü–æ), –∞ –º–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–ª–∞ ≈∑=0.9:
L = -[1*log(0.9) + 0*log(0.1)] = -log(0.9) ‚âà 0.105 (–º–∞–ª–∞—è –æ—à–∏–±–∫–∞)

–ï—Å–ª–∏ y=1, –∞ ≈∑=0.1:
L = -log(0.1) ‚âà 2.3 (–±–æ–ª—å—à–∞—è –æ—à–∏–±–∫–∞)
```

–°–≤–æ–π—Å—Ç–≤–æ: –û—á–µ–Ω—å —Å–∏–ª—å–Ω–æ —à—Ç—Ä–∞—Ñ—É–µ—Ç —É–≤–µ—Ä–µ–Ω–Ω—ã–µ, –Ω–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è!

5. Flatten() - –ü–ï–†–ï–•–û–î –û–¢ 2D –ö 1D

```python
layers.Flatten()  # –ü–æ—Å–ª–µ —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö —Å–ª–æ–µ–≤
```

–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:

```python
–î–æ Flatten: —Ñ–æ—Ä–º–∞ = (16, 16, 64)  # –≤—ã—Å–æ—Ç–∞, —à–∏—Ä–∏–Ω–∞, –∫–∞–Ω–∞–ª—ã
–ü–æ—Å–ª–µ Flatten: —Ñ–æ—Ä–º–∞ = (16384,)   # 16*16*64 = 16384
```

–ü–æ—á–µ–º—É –Ω—É–∂–Ω–æ:

¬∑ –°–≤–µ—Ä—Ç–æ—á–Ω—ã–µ —Å–ª–æ–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —Å 2D/3D –¥–∞–Ω–Ω—ã–º–∏
¬∑ –ü–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–µ (Dense) —Å–ª–æ–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ —Å 1D
¬∑ Flatten "—Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç" –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–π —Ç–µ–Ω–∑–æ—Ä –≤ –≤–µ–∫—Ç–æ—Ä

6. Dropout - –ó–ê–©–ò–¢–ê –û–¢ –ü–ï–†–ï–û–ë–£–ß–ï–ù–ò–Ø

```python
layers.Dropout(0.5)  # 50% –Ω–µ–π—Ä–æ–Ω–æ–≤ –æ—Ç–∫–ª—é—á–∞—é—Ç—Å—è —Å–ª—É—á–∞–π–Ω–æ
```

–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è:

```
–≠–ø–æ—Ö–∞ 1: –Ω–µ–π—Ä–æ–Ω—ã [1, 3, 5] –æ—Ç–∫–ª—é—á–µ–Ω—ã
–≠–ø–æ—Ö–∞ 2: –Ω–µ–π—Ä–æ–Ω—ã [2, 4, 6] –æ—Ç–∫–ª—é—á–µ–Ω—ã  
–≠–ø–æ—Ö–∞ 3: –Ω–µ–π—Ä–æ–Ω—ã [1, 4, 7] –æ—Ç–∫–ª—é—á–µ–Ω—ã
```

–í–æ –≤—Ä–µ–º—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è (inference):

¬∑ –í—Å–µ –Ω–µ–π—Ä–æ–Ω—ã –∞–∫—Ç–∏–≤–Ω—ã
¬∑ –í–µ—Å–∞ —É–º–Ω–æ–∂–∞—é—Ç—Å—è –Ω–∞ dropout rate (0.5) –¥–ª—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏

–ó–∞—á–µ–º: –ó–∞—Å—Ç–∞–≤–ª—è–µ—Ç —Å–µ—Ç—å –∏—Å–∫–∞—Ç—å "–∏–∑–±—ã—Ç–æ—á–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è", –Ω–µ –ø–æ–ª–∞–≥–∞—è—Å—å –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –Ω–µ–π—Ä–æ–Ω—ã.

7. ImageDataGenerator (–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –Ω–æ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å!)

–ü—Ä–æ–±–ª–µ–º–∞ —Ç–µ–∫—É—â–µ–≥–æ –∫–æ–¥–∞: –ù–µ—Ç –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö!

–ß—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–æ:

```python
from tensorflow.keras.preprocessing.image import ImageDataGenerator

datagen = ImageDataGenerator(
    rotation_range=20,      # –ü–æ–≤–æ—Ä–æ—Ç ¬±20 –≥—Ä–∞–¥—É—Å–æ–≤
    width_shift_range=0.2,  # –°–¥–≤–∏–≥ –ø–æ —à–∏—Ä–∏–Ω–µ ¬±20%
    height_shift_range=0.2, # –°–¥–≤–∏–≥ –ø–æ –≤—ã—Å–æ—Ç–µ ¬±20%
    zoom_range=0.2,         # –ó—É–º ¬±20%
    horizontal_flip=True,   # –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ—Ç—Ä–∞–∂–µ–Ω–∏–µ
    brightness_range=[0.8, 1.2]  # –ò–∑–º–µ–Ω–µ–Ω–∏–µ —è—Ä–∫–æ—Å—Ç–∏
)

# –í–º–µ—Å—Ç–æ model.fit():
history = model.fit(
    datagen.flow(X_train, y_train, batch_size=BATCH_SIZE),
    ...
)
```

8. train_test_split(stratify=y) - –ë–ê–õ–ê–ù–°–ò–†–û–í–ö–ê –ö–õ–ê–°–°–û–í

```python
stratify=y  # –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ –∫–ª–∞—Å—Å–æ–≤
```

–ë–µ–∑ stratify:

```
–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: 100 –ª–∏—Ü, 100 –Ω–µ-–ª–∏—Ü
Train: 80 –ª–∏—Ü, 80 –Ω–µ-–ª–∏—Ü  ‚úì (—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–æ)
Test:  20 –ª–∏—Ü, 20 –Ω–µ-–ª–∏—Ü  ‚úì
```

–° –ø–ª–æ—Ö–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (–±–µ–∑ stratify):

```
–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: 90 –ª–∏—Ü, 10 –Ω–µ-–ª–∏—Ü
Train: 72 –ª–∏—Ü, 8 –Ω–µ-–ª–∏—Ü    (9:1)
Test:  18 –ª–∏—Ü, 2 –Ω–µ-–ª–∏—Ü    (9:1) - –û–ß–ï–ù–¨ –ú–ê–õ–û –ø—Ä–∏–º–µ—Ä–æ–≤ –Ω–µ-–ª–∏—Ü!
```

–° stratify:

¬∑ –¢–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞ –±—É–¥–µ—Ç —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ç–∏–≤–Ω–æ–π
¬∑ –û—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω–æ –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–º –¥–∏—Å–±–∞–ª–∞–Ω—Å–µ –∫–ª–∞—Å—Å–æ–≤

9. EarlyStopping(patience=5) - –¢–û–ù–ö–ê–Ø –ù–ê–°–¢–†–û–ô–ö–ê

```python
patience=5  # –ñ–¥–∞—Ç—å 5 —ç–ø–æ—Ö –±–µ–∑ —É–ª—É—á—à–µ–Ω–∏—è
```

–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:

```
–≠–ø–æ—Ö–∞ 1: val_loss = 0.50  (–ª—É—á—à–∏–π)
–≠–ø–æ—Ö–∞ 2: val_loss = 0.48  (—É–ª—É—á—à–µ–Ω–∏–µ! –æ–±–Ω–æ–≤–ª—è–µ–º –ª—É—á—à–∏–π)
–≠–ø–æ—Ö–∞ 3: val_loss = 0.49  (—Ö—É–∂–µ, patience=1)
–≠–ø–æ—Ö–∞ 4: val_loss = 0.50  (—Ö—É–∂–µ, patience=2)
–≠–ø–æ—Ö–∞ 5: val_loss = 0.51  (—Ö—É–∂–µ, patience=3)
–≠–ø–æ—Ö–∞ 6: val_loss = 0.52  (—Ö—É–∂–µ, patience=4)
–≠–ø–æ—Ö–∞ 7: val_loss = 0.53  (—Ö—É–∂–µ, patience=5) ‚Üí –°–¢–û–ü!
```

restore_best_weights=True: –ü–æ—Å–ª–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ –≤–µ—Å–∞–º —ç–ø–æ—Ö–∏ 2.

10. –¶–í–ï–¢–û–í–´–ï –ü–†–û–°–¢–†–ê–ù–°–¢–í–ê: BGR vs RGB

```python
# –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ (OpenCV):
img = cv2.imread(...)  # BGR –ø–æ—Ä—è–¥–æ–∫!

# –ü—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ –¥–ª—è –º–æ–¥–µ–ª–∏:
img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)  # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ RGB

# –ü—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:
cv2.imwrite(temp_path, cv2.cvtColor(temp_img, cv2.COLOR_RGB2BGR))
```

–ü–æ—á–µ–º—É –ø—É—Ç–∞–Ω–∏—Ü–∞:

¬∑ –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏ OpenCV –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª BGR (—Å–∏–Ω–∏–π, –∑–µ–ª–µ–Ω—ã–π, –∫—Ä–∞—Å–Ω—ã–π)
¬∑ –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –º–æ–¥–µ–ª–µ–π –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫ (Matplotlib, TensorFlow) –∏—Å–ø–æ–ª—å–∑—É—é—Ç RGB
¬∑ –ï—Å–ª–∏ –Ω–µ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å: —Ü–≤–µ—Ç–∞ –±—É–¥—É—Ç –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã!

11. –†–ê–ó–ú–ï–†–ù–û–°–¢–ò –í –ö–û–û–†–î–ò–ù–ê–¢–ê–• OpenCV

```python
IMG_SIZE = (64, 64)  # (width, height) - –∫–∞–∫ –≤ OpenCV
input_shape=(IMG_SIZE[1], IMG_SIZE[0], 3)  # (height, width, channels)
```

–ü–æ—á–µ–º—É —Ç–∞–∫:

¬∑ OpenCV: (—à–∏—Ä–∏–Ω–∞, –≤—ã—Å–æ—Ç–∞)
¬∑ NumPy/Matplotlib: (–≤—ã—Å–æ—Ç–∞, —à–∏—Ä–∏–Ω–∞)
¬∑ TensorFlow: (–≤—ã—Å–æ—Ç–∞, —à–∏—Ä–∏–Ω–∞, –∫–∞–Ω–∞–ª—ã)

–†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω–∞—è –æ—à–∏–±–∫–∞:

```python
# –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:
cv2.resize(img, (height, width))  # –û—à–∏–±–∫–∞!

# –ü–†–ê–í–ò–õ–¨–ù–û:
cv2.resize(img, (width, height))
```

12. –û–¶–ï–ù–ö–ê –ö–ê–ß–ï–°–¢–í–ê –ú–û–î–ï–õ–ò

–ü–æ–º–∏–º–æ accuracy, –≤–∞–∂–Ω—ã:

```python
from sklearn.metrics import classification_report, confusion_matrix

# –ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫:
y_pred = (model.predict(X_test) > 0.5).astype("int32")
conf_matrix = confusion_matrix(y_test, y_pred)
# [[TN, FP],
#  [FN, TP]]

# –¢–æ—á–Ω–æ—Å—Ç—å –∏ –ø–æ–ª–Ω–æ—Ç–∞:
report = classification_report(y_test, y_pred)
# precision = TP / (TP + FP) - —Å–∫–æ–ª—å–∫–æ –∏–∑ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã—Ö –ª–∏—Ü –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ª–∏—Ü–∞
# recall = TP / (TP + FN)    - —Å–∫–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω—ã—Ö –ª–∏—Ü –º—ã –Ω–∞—à–ª–∏
```

–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø –≠–¢–û–ô –ú–û–î–ï–õ–ò:

1. –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö: –ú–æ–¥–µ–ª—å –≤—ã—É—á–∏—Ç —Ä–∏—Å–æ–≤–∞—Ç—å –æ–≤–∞–ª—ã, –∞ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å –ª–∏—Ü–∞
2. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ train/test split
3. –ù–µ—Ç –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ –∫–∞–Ω–∞–ª–∞–º: –¢–æ–ª—å–∫–æ –¥–µ–ª–µ–Ω–∏–µ –Ω–∞ 255, –±–µ–∑ –≤—ã—á–∏—Ç–∞–Ω–∏—è —Å—Ä–µ–¥–Ω–µ–≥–æ
4. –°–ª–∏—à–∫–æ–º –ø—Ä–æ—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: –î–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö –ª–∏—Ü –Ω—É–∂–Ω–æ 10+ —Å–ª–æ–µ–≤
5. –ß–µ—Ä–Ω–æ-–±–µ–ª—ã–µ –ª–∏—Ü–∞: –†–µ–∞–ª—å–Ω—ã–µ –ª–∏—Ü–∞ –∏–º–µ—é—Ç –≤–∞—Ä–∏–∞—Ü–∏–∏ —Ü–≤–µ—Ç–∞ –∫–æ–∂–∏

–≠—Ç–æ—Ç –∫–æ–¥ - –æ—Ç–ª–∏—á–Ω–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤, –Ω–æ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –Ω—É–∂–Ω—ã —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏!
